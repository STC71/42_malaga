# /api/auth/login -> POST only
SecRule REQUEST_URI "^/api/auth/login$" "id:900241,phase:1,deny,status:405,log,t:none,msg:'Restrict methods on /api/auth/login',chain"
SecRule REQUEST_METHOD "!@rx ^(?:%{tx.allowed_methods_auth_login})$" "t:none,chain"
SecRule REQUEST_METHOD "!@streq OPTIONS" "t:none"

# /api/upload -> POST only
SecRule REQUEST_URI "^/api/upload$" "id:900242,phase:1,deny,status:405,log,t:none,msg:'Restrict methods on /api/upload',chain"
SecRule REQUEST_METHOD "!@rx ^(?:%{tx.allowed_methods_upload})$" "t:none,chain"
SecRule REQUEST_METHOD "!@streq OPTIONS" "t:none"

# Everything else (NO API) -> GET, HEAD, OPTIONS
SecRule REQUEST_URI "!@beginsWith /api/" "id:900243,phase:1,deny,status:405,log,t:none,msg:'Restrict methods on non-API paths',chain"
SecRule REQUEST_METHOD "!@rx ^(?:%{tx.allowed_methods_non_api})$" "t:none,chain"
SecRule REQUEST_METHOD "!@streq OPTIONS" "t:none"
