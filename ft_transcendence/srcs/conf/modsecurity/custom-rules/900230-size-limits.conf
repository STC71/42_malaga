# These rules enforce size limits on incoming requests:
# - Block requests with more than 256 parameters.
# - Block requests with argument names longer than 50 characters.
# - Block requests with argument values longer than 64,000 characters.
# - Ensure JSON body processing for requests with Content-Type: application/json.
SecRule &ARGS "@gt %{tx.max_num_args}" "id:900231,phase:2,deny,status:413,log,msg:'Too many parameters'"

# If there are any argument names, check matched var length (starter has disruptive action; continuation no disrupt)
SecRule ARGS_NAMES "@rx .+" "id:900232,phase:2,deny,status:413,log,msg:'Argument name too long',t:none,chain"
SecRule MATCHED_VAR "@gt %{tx.arg_name_length}" "t:length"

# If there are any arguments, check values length (starter has disruptive action; continuation no disrupt)
SecRule &ARGS "@gt 0" "id:900233,phase:2,deny,status:413,log,msg:'Argument value too long',t:none,chain"
SecRule MATCHED_VAR "@gt %{tx.arg_length}" "t:length"
