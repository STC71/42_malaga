# This rule blocks requests with a Host header not in the allowed list.
# The allowed hostnames are defined in crs-setup.conf as tx.allowed_hostnames.
SecRule REQUEST_HEADERS:Host "!@rx ^(?:%{tx.allowed_hostnames})(?::[0-9]+)?$" \
    "id:900600,phase:1,deny,status:400,log,msg:'Host header not allowed: %{REQUEST_HEADERS.Host}',t:none"

# These rules block common XSS and SQL Injection attempts in request parameters.
# - Block XSS payloads such as <script>, onerror, onload, alert( in any argument.
# - Block basic SQL injection patterns using 'or', 'and', '=', or 'like'.
# - Block suspicious use of quotes in arguments that may indicate SQL injection.
# - Block command injection patterns using ; | ` &
SecRule ARGS "@rx %{tx.xss_pattern}" "id:900601,phase:2,deny,status:403,log,msg:'XSS attempt blocked',t:none"
SecRule ARGS "@rx (?i)%{tx.sqli_pattern}" "id:900602,phase:2,deny,status:403,log,msg:'SQLi attempt blocked',t:none"
SecRule ARGS "@rx %{tx.sqli_quote_pattern}" "id:900603,phase:2,deny,status:403,log,msg:'SQLi quote attempt blocked',t:none"
SecRule ARGS "@rx [;|`&]" "id:900604,phase:2,deny,status:403,log,msg:'Command injection attempt blocked',t:none"
