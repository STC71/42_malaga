# This rule disables ModSecurity processing for CORS preflight requests (OPTIONS with an Origin header).
# This prevents false positives and unnecessary blocking of legitimate CORS preflight requests.
SecRule REQUEST_METHOD "@streq OPTIONS" "id:900150,phase:1,pass,nolog,t:none,ctl:ruleEngine=Off,chain"
SecRule REQUEST_HEADERS:Origin "@rx .+" "t:none,chain"
SecRule TX:cors_preflight_disable "@eq 1" "t:none"
    