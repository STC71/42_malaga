# This rule blocks API responses to /api/ endpoints unless the Content-Type header is application/json or application/problem+json for most HTTP status codes.
# It enforces that successful and most error responses from the API are always in JSON format.
# EXEMPTED: /api/user/, /api/auth/, /api/chat/ endpoints allow 4xx responses without strict enforcement
SecRule REQUEST_URI "@beginsWith /api/" "id:900221,phase:3,deny,log,status:406,msg:'API 4xx response',t:none,chain"
SecRule REQUEST_URI "!@rx ^/api/(?:auth/|user/|chat/)" "t:none,chain"
SecRule RESPONSE_STATUS "@rx ^4" "t:none"
