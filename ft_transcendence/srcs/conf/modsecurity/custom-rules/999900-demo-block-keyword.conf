# Keep debug minimal in production
SecDebugLogLevel 0

# Demo: block requests containing demo keyword (expand tx.demo_block_keyword in setup)
SecRule ARGS|REQUEST_BODY|REQUEST_URI "@rx %{tx.demo_block_keyword}" \
    "id:999900,phase:2,deny,status:403,log,msg:'Demo block keyword detected: %{tx.demo_block_keyword}',t:none"

# Block any occurrence of the word 'malicious' (case-insensitive) across args/body/URI
SecRule ARGS|REQUEST_BODY|REQUEST_URI "@rx (?i)malicious" \
    "id:999901,phase:2,deny,status:403,log,msg:'Malicious keyword detected',t:none"

# Simple explicit check for parameter q == 'malicious' (kept for targeted tests)
SecRule ARGS:q "@streq malicious" \
    "id:999902,phase:2,deny,status:403,log,msg:'Simple malicious test rule activated',t:none"
