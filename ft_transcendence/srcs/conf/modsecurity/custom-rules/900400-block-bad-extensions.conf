# This rule blocks requests to /api/ endpoints that try to access files with dangerous extensions (php, jsp, asp, aspx, exe, sh, bat, cmd).
# It helps prevent attempts to exploit file execution or upload vulnerabilities.
SecRule REQUEST_URI "@rx (?i)^/api/.*\.(?:%{tx.blocked_extensions})(?:$|[?/#])" \
  "id:900400,phase:1,deny,status:403,log,t:none,msg:'Blocked dangerous extension under /api'"

# Block dangerous file extensions in uploaded files
SecRule FILES "@rx \.(?:%{tx.blocked_extensions})$" \
  "id:900401,phase:2,deny,status:403,log,t:none,msg:'Blocked dangerous file extension in upload'"
  