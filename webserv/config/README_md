# ğŸ“ CONFIGURACIÃ“N DEL SERVIDOR WEBSERV

Esta carpeta contiene los **archivos de configuraciÃ³n** para el servidor HTTP webserv. La sintaxis es similar a **Nginx** para facilitar la comprensiÃ³n y mantenimiento.

## ğŸ“‚ **ARCHIVOS DE CONFIGURACIÃ“N**

### ğŸ¯ **default.conf**
Archivo de configuraciÃ³n principal que define:
- **Virtual hosts** mÃºltiples
- **Puertos de escucha**
- **Rutas y ubicaciones**
- **Directivas de comportamiento**

## ğŸ”§ **SINTAXIS DE CONFIGURACIÃ“N**

### ğŸ“‹ **Estructura General**

```nginx
server {
    # Directivas del servidor
    listen puerto;
    server_name nombre;
    root directorio_raiz;
    
    # Ubicaciones especÃ­ficas
    location /ruta/ {
        # Directivas de ubicaciÃ³n
    }
}
```

### ğŸ® **Directivas Principales**

| Directiva              | DescripciÃ³n                     | Ejemplo                            | Obligatorio |
|------------------------|---------------------------------|------------------------------------|-------------|
| `listen`               | Puertos de escucha              | `listen 9000 9001;`                |      âœ…     |
| `server_name`          | Nombre del virtual host         | `server_name localhost;`           |      âœ…     |
| `root`                 | Directorio raÃ­z                 | `root www;`                        |      âœ…     |
| `index`                | Archivo Ã­ndice por defecto      | `index index.html;`                |      âŒ     |
| `client_max_body_size` | TamaÃ±o mÃ¡ximo del request       | `client_max_body_size 1024;`       |      âŒ     |
| `error_page`           | PÃ¡ginas de error personalizadas | `error_page 404 /errors/404.html;` |      âŒ     |

### ğŸ“ **Directivas de Location**

| Directiva              | DescripciÃ³n                      | Ejemplo                      | Valor por Defecto |
|------------------------|----------------------------------|------------------------------|-------------------|
| `methods`              | MÃ©todos HTTP permitidos          | `methods GET POST;`          | `GET`             |
| `root`                 | Override del root del servidor   | `root www/files;`            | Hereda del server |
| `directory_listing`    | Habilitar listado de directorios | `directory_listing on;`      | `off`             |
| `upload_path`          | Directorio para uploads          | `upload_path www/Uploads;`   | No definido       |
| `client_max_body_size` | Override del tamaÃ±o mÃ¡ximo       | `client_max_body_size 2048;` | Hereda del server |

## ğŸŒ **CONFIGURACIÃ“N DE VIRTUAL HOSTS**

### ğŸ¯ **Servidor Principal**

```nginx
server {
    listen 9000 9005;              # MÃºltiples puertos
    server_name localhost;          # Nombre del host
    root www;                       # Directorio raÃ­z
    index index.html;               # PÃ¡gina principal
    client_max_body_size 1024;     # LÃ­mite de tamaÃ±o (bytes)
    
    # PÃ¡ginas de error personalizadas
    error_page 400 /errors/400.html;
    error_page 403 /errors/403.html;
    error_page 404 /errors/404.html;
    error_page 405 /errors/405.html;
    error_page 413 /errors/413.html;
    error_page 500 /errors/500.html;
}
```

### ğŸ”„ **Virtual Host Secundario**

```nginx
server {
    listen 9000 9001 9002 9003;    # Otros puertos
    server_name site2.local;       # Nombre diferente
    root www2;                      # Directorio diferente
    index index.html;
    client_max_body_size 2048;     # LÃ­mite mayor
}
```

## ğŸ“‚ **CONFIGURACIÃ“N DE UBICACIONES**

### ğŸ  **UbicaciÃ³n RaÃ­z**

```nginx
location / {
    methods GET;                    # Solo lectura
    directory_listing on;           # Mostrar archivos
}
```

### â¬†ï¸ **UbicaciÃ³n de Uploads**

```nginx
location /Uploads {
    root www;                       # Base directory
    methods GET POST DELETE;        # Operaciones completas
    upload_path www/Uploads;        # Destino de uploads
    directory_listing on;           # Ver archivos subidos
    client_max_body_size 2048;     # LÃ­mite especÃ­fico
}
```

### ğŸ“„ **UbicaciÃ³n de Archivos EstÃ¡ticos**

```nginx
location /files {
    methods GET;                    # Solo lectura
    root www/files;                 # Directorio especÃ­fico
    directory_listing on;           # Mostrar contenido
}
```

### ğŸ **UbicaciÃ³n CGI**

```nginx
location /cgi-bin {
    methods GET POST;               # EjecuciÃ³n y datos
    root www/cgi-bin;              # Scripts CGI
    directory_listing off;          # No mostrar scripts
}
```

## ğŸ¯ **EJEMPLOS DE CONFIGURACIÃ“N**

### ğŸ“ **ConfiguraciÃ³n MÃ­nima**

```nginx
server {
    listen 8080;
    server_name localhost;
    root www;
    
    location / {
        methods GET;
    }
}
```

### ğŸ”§ **ConfiguraciÃ³n Completa**

```nginx
server {
    listen 9000 9005;
    server_name localhost;
    root www;
    index index.html;
    client_max_body_size 1024;
    
    error_page 404 /errors/404.html;
    error_page 500 /errors/500.html;
    
    location / {
        methods GET;
        directory_listing on;
    }
    
    location /Uploads {
        root www;
        methods GET POST DELETE;
        upload_path www/Uploads;
        directory_listing on;
        client_max_body_size 2048;
    }
    
    location /files {
        methods GET;
        root www/files;
        directory_listing on;
    }
    
    location /cgi-bin {
        methods GET POST;
        root www/cgi-bin;
        directory_listing off;
    }
}
```

## ğŸš¨ **NOTAS IMPORTANTES**

### âœ… **Buenas PrÃ¡cticas**

1. **ğŸ”’ Seguridad**: No habilitar `directory_listing` en ubicaciones sensibles
2. **ğŸ“ LÃ­mites**: Definir `client_max_body_size` apropiado para uploads
3. **ğŸ¯ MÃ©todos**: Restringir mÃ©todos HTTP segÃºn funcionalidad necesaria
4. **ğŸ“ Errores**: Definir pÃ¡ginas de error personalizadas
5. **ğŸ—‚ï¸ OrganizaciÃ³n**: Usar ubicaciones especÃ­ficas para diferentes tipos de contenido

### âš ï¸ **Errores Comunes**

- **âŒ Falta de `;`** al final de las directivas
- **âŒ Rutas incorrectas** en `root` o `upload_path`
- **âŒ Puertos duplicados** entre virtual hosts
- **âŒ MÃ©todos no vÃ¡lidos** (solo GET, POST, DELETE estÃ¡n soportados)
- **âŒ Archivos de error inexistentes** en `error_page`

## ğŸ” **VALIDACIÃ“N DE CONFIGURACIÃ“N**

### ğŸ§ª **Testing de ConfiguraciÃ³n**

```bash
# Verificar sintaxis
./webserv config/default.conf

# Testing especÃ­fico
curl -X GET http://localhost:9000/
curl -X POST -F "file=@test.txt" http://localhost:9000/Uploads
curl -X DELETE http://localhost:9000/files/test.txt

# Verificar virtual hosts
curl -H "Host: localhost" http://localhost:9000/
curl -H "Host: site2.local" http://localhost:9001/
```

### ğŸ“Š **Debugging**

```bash
# Logs del servidor (salida estÃ¡ndar)
./webserv config/default.conf

# Verificar puertos en uso
netstat -tulpn | grep :9000

# Testing con diferentes mÃ©todos
curl -X OPTIONS http://localhost:9000/
```

## ğŸ“ **RECURSOS ADICIONALES**

### ğŸ“š **DocumentaciÃ³n**

- **Sintaxis**: Similar a Nginx configuration
- **MÃ©todos HTTP**: RFC 7231 - HTTP/1.1 Semantics
- **CGI**: RFC 3875 - Common Gateway Interface
- **Upload**: RFC 1867 - Form-based File Upload

### ğŸ”— **Referencias**

- [Nginx Configuration Guide](https://nginx.org/en/docs/beginners_guide.html)
- [HTTP Methods](https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods)
- [HTTP Status Codes](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status)

---

## ğŸ“‹ **RESUMEN EJECUTIVO**

| ğŸ¯ Elemento           | ğŸ“Š Estado            | ğŸ“ Notas                        |
|-----------------------|----------------------|---------------------------------|
| **Virtual Hosts**     | âœ… Soportado         | MÃºltiples sitios en un servidor |
| **MÃ©todos HTTP**      | âœ… GET, POST, DELETE | MÃ©todos estÃ¡ndar implementados  |
| **File Uploads**      | âœ… Soportado         | Con lÃ­mites configurables       |
| **CGI Support**       | âœ… Soportado         | Python y PHP scripts            |
| **Error Pages**       | âœ… Personalizables   | PÃ¡ginas de error custom         |
| **Directory Listing** | âœ… Configurable      | Por ubicaciÃ³n especÃ­fica        |

**ğŸš€ ConfiguraciÃ³n lista para producciÃ³n con todas las funcionalidades del webserv implementadas.**